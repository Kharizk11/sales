# ููู ูุนูู ุงูุชุทุจูู - ุฏููู ุดุงูู

## ๐ ูุธุฑุฉ ุนุงูุฉ

ุงูุชุทุจูู ูุจูู ุนูู **Single Page Application (SPA)** ูุน ูุธุงู Router ูุฎุตุต. ูู ุตูุญุฉ ูููุตูุฉ ุชูุงูุงู ูุน ููู JavaScript ุฎุงุต ุจูุง.

---

## ๐ ุชุฏูู ุงูุนูู ุงููุงูู

### 1๏ธโฃ **ุจุฏุก ุงูุชุทุจูู (index.html)**

```
1. ุงููุณุชุฎุฏู ููุชุญ index.html
2. ูุชู ุชุญููู ุงููููุงุช ุงูุฃุณุงุณูุฉ ุจุงูุชุฑุชูุจ:
   โโโ js/core/config.js    (ุฅุนุฏุงุฏุงุช Firebase)
   โโโ js/core/utils.js     (ูุธุงุฆู ูุณุงุนุฏุฉ)
   โโโ js/core/data.js      (ุฅุฏุงุฑุฉ ุงูุจูุงูุงุช)
   โโโ js/core/router.js    (ูุธุงู ุงูุชููู)
3. ุนูุฏ ุชุญููู DOM:
   โโโ ุชููุฆุฉ Firebase
   โโโ ุฅุนุฏุงุฏ Firebase Listeners
   โโโ ุชููุฆุฉ Router
```

### 2๏ธโฃ **ูุธุงู Router (js/core/router.js)**

ุนูุฏ ุงูููุฑ ุนูู ุฑุงุจุท ูู ุงููุงุฆูุฉ:

```
ุงููุณุชุฎุฏู ูููุฑ ุนูู ุฑุงุจุท โ 
  โ
Router ููุชุดู ุงูููุฑ (data-navigate) โ
  โ
ูููุน ุงูุณููู ุงูุงูุชุฑุงุถู (preventDefault) โ
  โ
ูุณุชุฏุนู navigateTo('/page-name') โ
  โ
1. ูุธูุฑ ุดุงุดุฉ ุงูุชุญููู
2. ูุญูู HTML ูู pages/page-name.html
3. ูุณุชุฎุฑุฌ .main-content ูู HTML
4. ูุถูู ุงููุญุชูู ุฅูู .main-container
5. ูุญูู ููู JS ูู js/pages/page-name.js
6. ูุญุฏุซ URL ุจุฏูู ุฅุนุงุฏุฉ ุชุญููู
7. ูุฎูู ุดุงุดุฉ ุงูุชุญููู
8. ูุฑุณู ุญุฏุซ 'pageLoaded'
```

### 3๏ธโฃ **ุชุญููู ุงูุตูุญุฉ (ูุซุงู: home.html)**

```
1. Router ูุญูู pages/home.html
2. ูุณุชุฎุฑุฌ <div class="main-content">...</div>
3. ูุถููู ุฅูู .main-container ูู index.html
4. ูุญูู js/pages/home.js
5. ุนูุฏ ุชุญููู JS:
   โโโ ูุณุชูุน ูุญุฏุซ 'pageLoaded'
   โโโ ูุชุญูู ูู ุฃู ุงูุตูุญุฉ = 'home'
   โโโ ูุณุชุฏุนู updateDashboard()
```

### 4๏ธโฃ **ุฅุฏุงุฑุฉ ุงูุจูุงูุงุช (js/core/data.js)**

```
ุนูุฏ ุทูุจ ุงูุจูุงูุงุช (getSales/getBranches):
  โ
1. ูุชุญูู ูู ุงูุจูุงูุงุช ุงููุฎุฒูุฉ ูุญููุงู (cache)
2. ุฅุฐุง ููุฌูุฏุฉ โ ูุนูุฏูุง ูุจุงุดุฑุฉ
3. ุฅุฐุง ุบูุฑ ููุฌูุฏุฉ:
   โโโ ูุญุงูู ูู Firebase
   โโโ ุฅุฐุง ูุฌุญ โ ูุญูุธ ูู cache ููุนูุฏูุง
   โโโ ุฅุฐุง ูุดู โ ูุญุงูู ูู localStorage
4. ุนูุฏ ุงูุญูุธ (saveSales/saveBranches):
   โโโ ูุญูุธ ูู Firebase
   โโโ ูุญูุธ ูู localStorage (backup)
   โโโ ูุญุฏุซ cache
```

### 5๏ธโฃ **Firebase Listeners (Real-time Updates)**

```
ุนูุฏ setupFirebaseListeners():
  โ
1. ูุณุชูุน ูุชุบููุฑุงุช ูู collection 'sales'
2. ูุณุชูุน ูุชุบููุฑุงุช ูู collection 'branches'
3. ุนูุฏ ุฃู ุชุบููุฑ:
   โโโ ูุญุฏุซ ุงูุจูุงูุงุช ุงููุญููุฉ
   โโโ ูุฑุณู ุญุฏุซ ูุฎุตุต:
       โโโ 'salesUpdated' โ ุฌููุน ุงูุตูุญุงุช ุชุณุชูุน
       โโโ 'branchesUpdated' โ ุฌููุน ุงูุตูุญุงุช ุชุณุชูุน
```

---

## ๐ ูุซุงู ุนููู: ุตูุญุฉ ุงูุฑุฆูุณูุฉ

### ุงูุฎุทูุฉ 1: ุงููุณุชุฎุฏู ููุชุญ ุงูุชุทุจูู
```
index.html ูุชู ุชุญูููู
โ ุชุญููู config.js, utils.js, data.js, router.js
โ ุชููุฆุฉ Firebase
โ ุชููุฆุฉ Router
โ Router ููุชุดู URL = '/' ุฃู '/home'
โ ูุณุชุฏุนู navigateTo('home')
```

### ุงูุฎุทูุฉ 2: ุชุญููู ุตูุญุฉ ุงูุฑุฆูุณูุฉ
```
navigateTo('home'):
  โโโ fetch('pages/home.html')
  โโโ ุงุณุชุฎุฑุงุฌ .main-content
  โโโ ุฅุถุงูุฉ ุงููุญุชูู ุฅูู .main-container
  โโโ ุชุญููู js/pages/home.js
  โโโ ุฅุฑุณุงู ุญุฏุซ 'pageLoaded'
```

### ุงูุฎุทูุฉ 3: ุชููุฆุฉ ุตูุญุฉ ุงูุฑุฆูุณูุฉ
```
home.js ูุณุชูุน ูุญุฏุซ 'pageLoaded':
  โโโ ูุชุญูู: e.detail.page === 'home'
  โโโ ูุณุชุฏุนู updateDashboard()
  โโโ updateDashboard():
      โโโ getSales() โ ูุญุตู ุนูู ุงููุจูุนุงุช
      โโโ getBranches() โ ูุญุตู ุนูู ุงููุฑูุน
      โโโ ูุญุณุจ ุงูุฅุญุตุงุฆูุงุช
      โโโ ูุญุฏุซ DOM
```

### ุงูุฎุทูุฉ 4: ุชุญุฏูุซ ุชููุงุฆู
```
ุนูุฏ ุฅุถุงูุฉ ูุจูุนุงุช ุฌุฏูุฏุฉ:
  โโโ Firebase Listener ููุชุดู ุงูุชุบููุฑ
  โโโ ูุฑุณู ุญุฏุซ 'salesUpdated'
  โโโ home.js ูุณุชูุน ููุญุฏุซ:
      โโโ ูุณุชุฏุนู updateDashboard() ุชููุงุฆูุงู
```

---

## ๐ ุงูุชููู ุจูู ุงูุตูุญุงุช

### ุนูุฏ ุงูููุฑ ุนูู "ุงููุฑูุน":
```
1. Router ููุชุดู ุงูููุฑ ุนูู <a href="/branches" data-navigate>
2. ูุณุชุฏุนู navigateTo('/branches')
3. ูุญูู pages/branches.html
4. ูุญูู js/pages/branches.js
5. branches.js ูุณุชูุน ูุญุฏุซ 'pageLoaded'
6. ูุณุชุฏุนู renderBranchesTable()
7. ูุนุฑุถ ุฌุฏูู ุงููุฑูุน
```

### ุนูุฏ ุงูููุฑ ุนูู "ุงููุจูุนุงุช":
```
1. Router ูุณุชุฏุนู navigateTo('/sales')
2. ูุญูู pages/sales.html
3. ูุญูู js/pages/sales.js
4. sales.js:
   โโโ ูููุฃ select ุงููุฑูุน
   โโโ ูุณุชุฏุนู loadSalesTable()
   โโโ ูุนุฑุถ ุฌุฏูู ุงููุจูุนุงุช
```

---

## ๐พ ุชุฎุฒูู ุงูุจูุงูุงุช

### ุงูุชุณูุณู ุงููุฑูู ููุชุฎุฒูู:
```
1. Cache (ูู ุงูุฐุงูุฑุฉ) โ ุงูุฃุณุฑุน
   โ ุฅุฐุง ุบูุฑ ููุฌูุฏ
2. Firebase โ ุงูุณุญุงุจุฉ (Real-time)
   โ ุฅุฐุง ูุดู
3. localStorage โ ุงูุชุฎุฒูู ุงููุญูู
```

### ุนูุฏ ุงูุญูุธ:
```
saveSales(sales):
  โโโ ูุญูุธ ูู Firebase (ุฅุฐุง ูุชุงุญ)
  โโโ ูุญูุธ ูู localStorage (backup)
  โโโ ูุญุฏุซ cache
```

---

## ๐ฏ ุงูุฃุญุฏุงุซ ุงููุฎุตุตุฉ (Custom Events)

ุงูุชุทุจูู ูุณุชุฎุฏู ุฃุญุฏุงุซ ูุฎุตุตุฉ ููุชูุงุตู ุจูู ุงูููููุงุช:

### 1. `pageLoaded`
```javascript
// ูุฑุณู ุนูุฏ ุชุญููู ุตูุญุฉ ุฌุฏูุฏุฉ
window.dispatchEvent(new CustomEvent('pageLoaded', { 
  detail: { page: 'home' } 
}));

// ุงูุตูุญุงุช ุชุณุชูุน ูู:
window.addEventListener('pageLoaded', function(e) {
  if (e.detail.page === 'home') {
    // ุชููุฆุฉ ุงูุตูุญุฉ
  }
});
```

### 2. `salesUpdated`
```javascript
// ูุฑุณู ุนูุฏ ุชุญุฏูุซ ุงููุจูุนุงุช
window.dispatchEvent(new CustomEvent('salesUpdated', { 
  detail: sales 
}));

// ุงูุตูุญุงุช ุชุณุชูุน ูุชุญุฏุซ ููุณูุง ุชููุงุฆูุงู
```

### 3. `branchesUpdated`
```javascript
// ูุฑุณู ุนูุฏ ุชุญุฏูุซ ุงููุฑูุน
// ููุณ ุงููุจุฏุฃ
```

---

## ๐ ูุซุงู: ุฅุถุงูุฉ ูุจูุนุงุช ุฌุฏูุฏุฉ

```
1. ุงููุณุชุฎุฏู ูููุฃ ุงููููุฐุฌ ูู sales.html
2. ูููุฑ "ุญูุธ ุงูุณุฌู"
3. handleSalesSubmit():
   โโโ ูุฌูุน ุงูุจูุงูุงุช ูู ุงููููุฐุฌ
   โโโ getSales() โ ูุญุตู ุนูู ุงููุจูุนุงุช ุงูุญุงููุฉ
   โโโ ูุถูู ุงูุณุฌู ุงูุฌุฏูุฏ
   โโโ saveSales() โ ูุญูุธ
   โโโ loadSalesTable() โ ูุญุฏุซ ุงูุฌุฏูู
4. Firebase Listener ููุชุดู ุงูุชุบููุฑ
5. ูุฑุณู ุญุฏุซ 'salesUpdated'
6. ุฌููุน ุงูุตูุญุงุช ุงูุชู ุชุณุชูุน:
   โโโ home.js โ ูุญุฏุซ Dashboard
   โโโ reports.js โ ูุญุฏุซ ุงูุชูุงุฑูุฑ (ุฅุฐุง ูุงูุช ููุชูุญุฉ)
   โโโ sales.js โ ูุญุฏุซ ุงูุฌุฏูู
```

---

## ๐ง ุงููููุงุช ุงูุฃุณุงุณูุฉ

### `js/core/config.js`
- ูุญุชูู ุนูู ุฅุนุฏุงุฏุงุช Firebase
- ููุงุชูุญ ุงูุชุฎุฒูู
- ุฃุณูุงุก Collections

### `js/core/utils.js`
- ูุธุงุฆู ูุณุงุนุฏุฉ ูุดุชุฑูุฉ
- formatDate, formatMoney, showToast, etc.
- ูุชุงุญุฉ ุนุงูููุงู ุนุจุฑ `window`

### `js/core/data.js`
- ุฅุฏุงุฑุฉ ุฌููุน ุงูุจูุงูุงุช
- getSales(), saveSales(), getBranches(), saveBranches()
- Firebase + localStorage
- Real-time listeners

### `js/core/router.js`
- ูุธุงู ุงูุชููู
- navigateTo(), loadPageScript()
- ุชุญุฏูุซ URL
- ูุนุงูุฌุฉ ุงูุฃุญุฏุงุซ

---

## ๐ฑ ุงูุตูุญุงุช ุงููููุตูุฉ

ูู ุตูุญุฉ ูุณุชููุฉ ุชูุงูุงู:

### `pages/home.html` + `js/pages/home.js`
- ุนุฑุถ ุงูุฅุญุตุงุฆูุงุช
- ุขุฎุฑ ุงููุจูุนุงุช
- ูุณุชูุน ูู `salesUpdated`

### `pages/branches.html` + `js/pages/branches.js`
- ุฅุฏุงุฑุฉ ุงููุฑูุน
- ุฅุถุงูุฉ/ุชุนุฏูู/ุญุฐู
- ูุณุชูุน ูู `branchesUpdated`

### `pages/sales.html` + `js/pages/sales.js`
- ุชุณุฌูู ุงููุจูุนุงุช
- ุนุฑุถ ุงูุฌุฏูู
- ููุชุฑุฉ ูุชุตุฏูุฑ
- ูุณุชูุน ูู `salesUpdated`

### `pages/reports.html` + `js/pages/reports.js`
- ุงูุชูุงุฑูุฑ ูุงูุชุญูููุงุช
- ุฅุญุตุงุฆูุงุช ููุตูุฉ
- ุฌุฏุงูู ูุฑุณูู ุจูุงููุฉ

---

## ๐จ ุงูุชุตููู

### `css/styles.css`
- ุฌููุน ุงูุฃููุงุท ูู ููู ูุงุญุฏ
- ูุชุบูุฑุงุช CSS ููุฃููุงู
- ุชุตููู ูุชุฌุงูุจ
- ุฃููุงุท ูุดุชุฑูุฉ ูุฌููุน ุงูุตูุญุงุช

---

## โ ุงููููุฒุงุช ุงูุฑุฆูุณูุฉ

1. **ูุตู ูุงูู**: ูู ุตูุญุฉ ูุณุชููุฉ
2. **Router ุฐูู**: ุชููู ุจุฏูู ุฅุนุงุฏุฉ ุชุญููู
3. **Real-time**: ุชุญุฏูุซ ุชููุงุฆู ูู Firebase
4. **Offline Support**: ูุนูู ูุน localStorage
5. **Events System**: ุชูุงุตู ุจูู ุงูููููุงุช
6. **Modular**: ุณูู ุงูุตูุงูุฉ ูุงูุชุทููุฑ

---

## ๐ ุฅุถุงูุฉ ุตูุญุฉ ุฌุฏูุฏุฉ

```javascript
// 1. ุฃูุดุฆ pages/new-page.html
<div class="main-content">
  <!-- ูุญุชูู ุงูุตูุญุฉ -->
</div>

// 2. ุฃูุดุฆ js/pages/new-page.js
window.addEventListener('pageLoaded', function(e) {
  if (e.detail.page === 'new-page') {
    // ุชููุฆุฉ ุงูุตูุญุฉ
  }
});

// 3. ุฃุถู ุงููุณุงุฑ ูู router.js
const ROUTES = {
  '/new-page': 'pages/new-page.html'
};

const scriptMap = {
  'new-page': 'js/pages/new-page.js'
};

// 4. ุฃุถู ุฑุงุจุท ูู index.html
<a href="/new-page" class="nav-link" data-navigate>ุตูุญุฉ ุฌุฏูุฏุฉ</a>
```

---

## ๐ ููุงุญุธุงุช ูููุฉ

- **ุงูุชุฑุชูุจ ููู**: ุงููููุงุช ุงูุฃุณุงุณูุฉ ุชูุญูู ุจุงูุชุฑุชูุจ
- **ุงูุฃุญุฏุงุซ**: ุงุณุชุฎุฏู Custom Events ููุชูุงุตู
- **ุงูุจูุงูุงุช**: ุฏุงุฆูุงู ุงุณุชุฎุฏู getSales()/getBranches() ูู data.js
- **ุงูุชุญุฏูุซุงุช**: Firebase Listeners ุชุญุฏุซ ุชููุงุฆูุงู
- **ุงูุตูุญุงุช**: ูู ุตูุญุฉ ุชุณุชูุน ูู 'pageLoaded' ูุชููุฆุฉ ููุณูุง








